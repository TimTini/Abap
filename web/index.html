<!doctype html>
<html lang="vi">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ABAP Flow Analyzer (Offline)</title>
    <link rel="stylesheet" href="css/app.css" />
    <link rel="stylesheet" href="css/templates.css" />
  </head>
  <body>
    <header class="app-header">
      <div class="app-header__title">
        <h1>ABAP Flow Analyzer</h1>
        <div class="app-header__subtitle">Offline - No external libraries</div>
      </div>
      <div class="app-header__actions">
        <button id="btnAnalyze" class="btn btn-primary" type="button">Analyze</button>
        <button id="btnLoadSample" class="btn" type="button">Load sample</button>
        <button id="btnClear" class="btn" type="button">Clear</button>
        <button id="btnExportNotes" class="btn" type="button">Export notes</button>
        <button id="btnImportNotes" class="btn" type="button">Import notes</button>
        <input id="notesImportFile" type="file" accept="application/json" style="display:none" />
      </div>
    </header>

    <main class="app-main app-main--resizable">
      <section class="panel panel-left">
        <div class="panel__title">ABAP code</div>
        <div class="code-editor">
          <textarea id="abapInput" class="code-input" spellcheck="false" placeholder="Paste ABAP code here..."></textarea>
          <div id="abapLineNumbers" class="code-line-numbers" aria-hidden="true"></div>
          <div id="abapTemplateMarkers" class="code-markers" aria-hidden="true"></div>
        </div>
        <div class="panel__footer">
          <div id="statusBar" class="status-bar">Ready.</div>
        </div>
      </section>

      <div id="mainSplitter" class="app-splitter" role="separator" aria-orientation="vertical" tabindex="0"></div>

      <section class="panel panel-right">
        <div class="tabs">
          <button class="tab is-active" data-tab="objects" type="button">Objects</button>
          <button class="tab" data-tab="templates" type="button">Templates</button>
          <button class="tab" data-tab="config" type="button">Config</button>
          <button class="tab" data-tab="json" type="button">JSON</button>
          <button class="tab" data-tab="xml" type="button">XML</button>
        </div>

        <div class="tab-panels">
          <section class="tab-panel is-active" id="tab-objects">
            <div class="split">
              <div class="split__left">
                <div class="toolbar">
                  <input id="objectSearch" class="input" type="search" placeholder="Search (FORM, EVENT, name)..." />
                </div>
                <div class="table-wrap">
                  <table class="table" id="objectsTable">
                    <thead>
                      <tr>
                        <th>Kind</th>
                        <th>Name</th>
                        <th>Depth</th>
                        <th>Params</th>
                        <th>DATA</th>
                        <th>CONST</th>
                        <th>Writes</th>
                        <th>Assign</th>
                        <th>Defined</th>
                        <th>Cycle</th>
                      </tr>
                    </thead>
                    <tbody></tbody>
                  </table>
                </div>
              </div>
              <div class="split__right">
                <div class="panel__title">Details</div>
                <div id="objectDetails" class="details empty">Analyze to see details.</div>
              </div>
            </div>
          </section>

          <section class="tab-panel" id="tab-templates">
            <div class="panel__title">Template output (flow order)</div>
            <div id="templatesHost" class="trace-results empty">Analyze to see templates.</div>
            <div class="hint">Tip: click a block to highlight the original statement in the editor.</div>
          </section>

          <section class="tab-panel" id="tab-config">
            <div class="split objcfg">
              <div class="split__left">
                <div class="toolbar objcfg-toolbar">
                  <input id="abapObjCfgSearch" class="input" type="search" placeholder="Search (id/label/kind)..." />
                  <button id="abapObjCfgNew" class="btn" type="button">New</button>
                </div>
                <div id="abapObjCfgList" class="objcfg-list"></div>
                <div class="toolbar objcfg-toolbar objcfg-toolbar--bottom">
                  <button id="abapObjCfgExport" class="btn" type="button">Export</button>
                  <button id="abapObjCfgImport" class="btn" type="button">Import</button>
                  <button id="abapObjCfgResetAll" class="btn" type="button">Reset all</button>
                  <input id="abapObjCfgImportFile" type="file" accept="application/json" style="display:none" />
                </div>
              </div>
              <div class="split__right">
                <div class="panel__title">ABAP Objects config (localStorage)</div>
                <div class="objcfg-right">
                  <details id="abapObjCfgGen" class="objcfg-gen">
                    <summary class="objcfg-advanced__summary">Generate from ABAP syntax (beta)</summary>
                    <textarea
                      id="abapObjCfgGenInput"
                      class="objcfg-json objcfg-json--small"
                      spellcheck="false"
                      placeholder="Paste ABAP Doc syntax block here (example: CONCATENATE ... INTO result ...)."
                    ></textarea>
                    <div class="objcfg-gen__row">
                      <input id="abapObjCfgGenId" class="input" type="text" placeholder="Object id (optional)" />
                      <button id="abapObjCfgGenBtn" class="btn btn-primary" type="button">Generate</button>
                    </div>
                    <pre id="abapObjCfgGenOutput" class="objcfg-gen__output"></pre>
                  </details>

                  <div id="abapObjCfgEditor" class="details empty">Select an object on the left.</div>
                </div>
              </div>
            </div>
          </section>

          <section class="tab-panel" id="tab-json">
            <div class="panel__title">Model JSON</div>
            <pre id="jsonOutput" class="json-output empty">Analyze to see JSON.</pre>
          </section>

          <section class="tab-panel" id="tab-xml">
            <div class="panel__title">ABAP Objects XML (Templates)</div>
            <div class="toolbar objcfg-toolbar">
              <button id="btnCopyXml" class="btn btn-sm btn-primary" type="button">Copy</button>
              <button id="btnDownloadXml" class="btn btn-sm" type="button">Download</button>
              <label style="margin-left:auto;display:flex;gap:6px;align-items:center;color:var(--muted);font-size:12px;">
                Max steps
                <input id="xmlMaxSteps" class="input" type="number" min="100" step="100" value="5000" style="width:110px;" />
              </label>
            </div>
            <pre id="xmlOutput" class="json-output empty">Analyze to see XML.</pre>
          </section>
        </div>
      </section>
    </main>

    <script src="js/namespace.js"></script>
    <script src="abap_objects.config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/template_defs_store.js"></script>
    <script src="js/abap_objects/custom_store.js"></script>
    <script src="js/logic.js"></script>
    <script src="js/notes.js"></script>
    <script src="js/model.js"></script>
    <script src="js/abap_objects/schema.js"></script>
    <script src="js/abap_objects/parsers.js"></script>
    <script src="js/abap_objects/loader.js"></script>
    <script src="js/abap_objects/syntax_generator.js"></script>
    <script src="js/doc.js"></script>
    <script src="js/graph.js"></script>
    <script src="js/lineage.js"></script>
    <script src="js/desc_resolver.js"></script>
    <script src="js/parser.js"></script>
    <script src="js/sample.js"></script>
    <script src="js/template_converter.js"></script>
    <script src="js/ui_core.js"></script>
    <script src="js/ui_abap_line_numbers.js"></script>
    <script src="js/ui_abap_markers.js"></script>
    <script src="js/ui_anno.js"></script>
    <script src="js/ui_objects_list.js"></script>
    <script src="js/ui_objects_details.js"></script>
    <script src="js/ui_abap_objects_config.js"></script>
    <script src="js/ui_abap_objects_syntax_generator.js"></script>
    <script src="js/ui_templates_store.js"></script>
    <script src="js/ui_templates_flow.js"></script>
    <script src="js/ui_clipboard.js"></script>
    <script src="js/ui_templates_render.js"></script>
    <script src="js/ui_views.js"></script>
    <script src="js/ui.js"></script>
  </body>
</html>
